import{d as e,r as a,z as l,c as t,a4 as u,K as o,aI as r,v as s,J as i,b as n,e as c,f as m,g as d,w as v,h as f,A as p,p as h,B as y,k as g,i as b,t as _,F as k,x as C,j as V,aV as x,ay as $,m as w,n as F,I as S,aw as T,ab as P}from"./index-Bl407YMq.js";import{b as D,d as H,c as M,m as j,f as K,g as L,a as z,_ as I}from"./base64.CiSqhNY6.js";import{_ as A,g as B}from"./ht-datetime-picker-view.Df6sr5tD.js";import{f as O,u as q,b as W,F as U}from"./ht-loading.DCn6to1m.js";import{u as N}from"./useTranslate.C8VGrN03.js";import{d as R}from"./dayjs.BQz75yJF.js";const Y=I(e({name:"ht-datetime-picker",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...D,label:String,placeholder:String,disabled:H(!1),readonly:H(!1),loading:H(!1),loadingColor:M("#4D80F0"),title:String,cancelButtonText:String,confirmButtonText:String,required:H(!1),size:String,labelWidth:M("33%"),useDefaultSlot:H(!1),useLabelSlot:H(!1),error:H(!1),alignRight:H(!1),closeOnClickModal:H(!0),safeAreaInsetBottom:H(!0),ellipsis:H(!1),columnsHeight:j(217),valueKey:M("value"),labelKey:M("label"),modelValue:K([String,Number,Array]),type:M("datetime"),minDate:j(new Date((new Date).getFullYear()-10,0,1).getTime()),maxDate:j(new Date((new Date).getFullYear()+10,11,31,23,59,59).getTime()),minHour:j(0),maxHour:j(23),minMinute:j(0),maxMinute:j(59),filter:Function,formatter:Function,displayFormat:Function,beforeConfirm:Function,displayFormatTabLabel:Function,defaultValue:[String,Number,Array],zIndex:j(15),prop:String,rules:L(),customCellClass:M(""),customViewClass:M(""),customLabelClass:M(""),customValueClass:M(""),immediateChange:H(!1)},emits:["change","open","toggle","cancel","confirm","update:modelValue"],setup(e,{expose:D,emit:H}){const M=e,j=H,{translate:K}=N("datetime-picker"),L=a(),I=a(),Y=a(""),G=a(!1),J=a(!0),E=a(!1),Q=a([]),X=a(""),Z=a(""),ee=a(!1),ae=a(!1),le=a(!1),{proxy:te}=S(),ue=O();l((()=>M.modelValue),((e,a)=>{T(e,a)||(o(e)?(E.value=!0,X.value=r(de(!0)),Z.value=r(de(!0,!0))):X.value=r(de()),$((()=>{Ve(!1,!1,!0)})))}),{deep:!0,immediate:!0}),l((()=>M.displayFormat),(e=>{e&&!P(e)&&console.error("The type of displayFormat must be Function")}),{deep:!0,immediate:!0}),l((()=>M.filter),(e=>{e&&!P(e)&&console.error("The type of filter must be Function")}),{deep:!0,immediate:!0}),l((()=>M.formatter),(e=>{e&&!P(e)&&console.error("The type of formatter must be Function")}),{deep:!0,immediate:!0}),l((()=>M.beforeConfirm),(e=>{e&&!P(e)&&console.error("The type of beforeConfirm must be Function")}),{deep:!0,immediate:!0}),l((()=>M.displayFormatTabLabel),(e=>{e&&!P(e)&&console.error("The type of displayFormatTabLabel must be Function")}),{deep:!0,immediate:!0}),l((()=>M.defaultValue),(e=>{o(e)||E.value?(X.value=r(de(!0)),Z.value=r(de(!0,!0))):X.value=r(de())}),{deep:!0,immediate:!0});const{parent:oe}=q(U),re=t((()=>oe&&M.prop&&oe.errorMessages&&oe.errorMessages[M.prop]?oe.errorMessages[M.prop]:"")),se=t((()=>{let e=!1;if(oe&&oe.props.rules){const a=oe.props.rules;for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&l===M.prop&&Array.isArray(a[l])&&(e=a[l].some((e=>e.required)))}return M.required||M.rules.some((e=>e.required))||e}));function ie(e,a,l,t,u){const{type:o}=M;switch(o){case"datetime":{const[o,r,s,i,n]=u;if("year"===a)return e?l>o:l<o;if("month"===a&&t[0]===o)return e?l>r:l<r;if("date"===a&&t[0]===o&&t[1]===r)return e?l>s:l<s;if("hour"===a&&t[0]===o&&t[1]===r&&t[2]===s)return e?l>i:l<i;if("minute"===a&&t[0]===o&&t[1]===r&&t[2]===s&&t[3]===i)return e?l>n:l<n;break}case"year-month":{const[o,r]=u;if("year"===a)return e?l>o:l<o;if("month"===a&&t[0]===o)return e?l>r:l<r;break}case"year":{const[t]=u;if("year"===a)return e?l>t:l<t;break}case"date":{const[o,r,s]=u;if("year"===a)return e?l>o:l<o;if("month"===a&&t[0]===o)return e?l>r:l<r;if("date"===a&&t[0]===o&&t[1]===r)return e?l>s:l<s;break}case"time":{const[o,r]=u;if("hour"===a)return e?l>o:l<o;if("minute"===a&&t[0]===o)return e?l>r:l<r;break}}return!1}const ne=e=>{if(!e)return[];const{type:a}=M,{startSymbol:l,formatter:t}=e,u=e.correctValue(X.value),o=e.correctValue(Z.value),r=l?e.getPickerValue(u,a):e.getPickerValue(o,a),s=l?e.getPickerValue(o,a):e.getPickerValue(u,a);return e.getOriginColumns().map(((e,a)=>e.values.map((a=>{const u=ie(l,e.type,a,r,s);return{label:t?t(e.type,x(a)):x(a),value:a,disabled:u}}))))};function ce(e){let a="before"===e?X.value:Z.value,l=[];return a&&(l=B(a,M.type)),l.map((e=>({[M.labelKey]:x(e),[M.valueKey]:e})))}function me(){}function de(e,a){const{modelValue:l,defaultValue:t,maxDate:u,minDate:r,type:s}=M;if(e){const e=a?1:0,i=o(l)?l[e]:"",n=o(t)?t[e]:"",c="time"===s?R(u).format("HH:mm"):u,m="time"===s?R(r).format("HH:mm"):r;return i||n||(a?c:m)}return i(l||t)?l||t:""}function ve(){M.disabled||M.readonly||(j("open"),E.value?(G.value=!0,J.value=!0,X.value=r(de(!0,!1)),Z.value=r(de(!0,!0))):(G.value=!0,X.value=r(de())),Ve(!0,!1,!0))}function fe(){J.value=!J.value;const e=J.value?L.value:I.value;e.setColumns(e.updateColumns()),j("toggle",J.value?X.value:Z.value)}function pe({value:e}){if(L.value&&(!E.value||I.value))if(E.value){const a=L.value.getPickerValue(e,M.type),l=L.value.getPickerValue(Z.value,M.type),t=L.value.getOriginColumns().some(((e,t)=>ie(!0,e.type,a[t],a,l)));X.value=r(t?Z.value:e),$((()=>{Q.value=[Ce(),r(Q.value[1])],j("change",{value:[X.value,Z.value]}),L.value&&L.value.setColumns(L.value.updateColumns()),I.value&&I.value.setColumns(I.value.updateColumns())}))}else X.value=r(e),j("change",{value:X.value})}function he({value:e}){if(!L.value||!I.value)return;const a=I.value.getPickerValue(e,M.type),l=I.value.getPickerValue(X.value,M.type),t=I.value.getOriginColumns().some(((e,t)=>ie(!1,e.type,a[t],a,l)));Z.value=r(t?X.value:e),$((()=>{Q.value=[r(Q.value[0]),Ce(1)],j("change",{value:[X.value,Z.value]}),L.value&&L.value.setColumns(L.value.updateColumns()),I.value&&I.value.setColumns(I.value.updateColumns())}))}function ye(){G.value=!1,setTimeout((()=>{E.value?(X.value=r(de(!0)),Z.value=r(de(!0,!0))):X.value=r(de())}),200),j("cancel")}function ge(){if(M.loading||le.value)return;if(ee.value)return void(ae.value=!0);const{beforeConfirm:e}=M;e?e(E.value?[X.value,Z.value]:X.value,(e=>{e&&ke()}),te.$.exposed):ke()}function be(){ee.value=!0}function _e(){ee.value=!1,setTimeout((()=>{ae.value&&(ae.value=!1,ge())}),50)}function ke(){if(M.loading||le.value||M.disabled)return void(G.value=!1);const e=E.value?[X.value,Z.value]:X.value;G.value=!1,j("update:modelValue",e),j("confirm",{value:e}),Ve(!1,!0)}function Ce(e=0){if(E.value){let a=[];return a=0===e?(L.value?L.value.getSelects():void 0)||X.value&&ce("before"):(I.value?I.value.getSelects():void 0)||Z.value&&ce("after"),xe(a,!0)}return""}function Ve(e=!1,a=!1,l=!1){if(E.value){const t=l?X.value&&ce("before")||[]:L.value&&L.value.getSelects&&L.value.getSelects()||[],u=l?Z.value&&ce("after")||[]:I.value&&I.value.getSelects&&I.value.getSelects()||[];Y.value=e?Y.value:[M.modelValue[0]||a?xe(t):"",M.modelValue[1]||a?xe(u):""],Q.value=[xe(t,!0),xe(u,!0)]}else{const e=l?X.value&&ce("before")||[]:L.value&&L.value.getSelects&&L.value.getSelects()||[];Y.value=r(M.modelValue||a?xe(e):"")}}function xe(e,a=!1){if(0===e.length)return"";if(a&&M.displayFormatTabLabel)return M.displayFormatTabLabel(e);if(M.displayFormat)return M.displayFormat(e);if(M.formatter){const a={year:["year"],datetime:["year","month","date","hour","minute"],date:["year","month","date"],time:["hour","minute"],"year-month":["year","month"]};return e.map(((e,l)=>M.formatter(a[M.type][l],e.value))).join("")}switch(M.type){case"year":return e[0].label;case"date":return`${e[0].label}-${e[1].label}-${e[2].label}`;case"year-month":return`${e[0].label}-${e[1].label}`;case"time":return`${e[0].label}:${e[1].label}`;case"datetime":return`${e[0].label}-${e[1].label}-${e[2].label} ${e[3].label}:${e[4].label}`}}return u((()=>{const{modelValue:e}=M;o(e)?(E.value=!0,X.value=r(de(!0)),Z.value=r(de(!0,!0))):X.value=r(de())})),s((()=>{Ve(!1,!1,!0)})),D({open:function(){ve()},close:function(){ye()},setLoading:function(e){le.value=e}}),(e,a)=>{const l=w,t=F,u=n(c("ht-icon"),z),r=n(c("ht-datetime-picker-view"),A),s=n(c("ht-popup"),W);return m(),d(l,{class:h(`ht-picker ${e.disabled?"is-disabled":""} ${e.size?"is-"+e.size:""}  ${V(ue).border.value?"is-border":""} ${e.alignRight?"is-align-right":""} ${e.error?"is-error":""} ${e.customClass}`),style:y(e.customStyle)},{default:v((()=>[f(l,{class:"ht-picker__field",onClick:ve},{default:v((()=>[e.$slots.default?p(e.$slots,"default",{key:0},void 0,!0):(m(),d(l,{key:1,class:h(["ht-picker__cell",e.customCellClass])},{default:v((()=>[e.label||e.$slots.label?(m(),d(l,{key:0,class:h(`ht-picker__label ${e.customLabelClass} ${se.value?"is-required":""}`),style:y(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:v((()=>[e.$slots.label?p(e.$slots,"label",{key:0},void 0,!0):(m(),g(k,{key:1},[b(_(e.label),1)],64))])),_:3},8,["class","style"])):C("",!0),f(l,{class:"ht-picker__body"},{default:v((()=>[f(l,{class:"ht-picker__value-wraper"},{default:v((()=>[f(l,{class:h(`ht-picker__value ${e.customValueClass}`)},{default:v((()=>[E.value?(m(),g(k,{key:0},[V(o)(Y.value)?(m(),d(l,{key:0},{default:v((()=>[f(t,{class:h(Y.value[0]?"":"ht-picker__placeholder")},{default:v((()=>[b(_(Y.value[0]?Y.value[0]:e.placeholder||V(K)("placeholder")),1)])),_:1},8,["class"]),b(" "+_(V(K)("to"))+" ",1),f(t,{class:h(Y.value[1]?"":"ht-picker__placeholder")},{default:v((()=>[b(_(Y.value[1]?Y.value[1]:e.placeholder||V(K)("placeholder")),1)])),_:1},8,["class"])])),_:1})):(m(),d(l,{key:1,class:"ht-picker__placeholder"},{default:v((()=>[b(_(e.placeholder||V(K)("placeholder")),1)])),_:1}))],64)):(m(),d(l,{key:1,class:h(Y.value?"":"ht-picker__placeholder")},{default:v((()=>[b(_(Y.value?Y.value:e.placeholder||V(K)("placeholder")),1)])),_:1},8,["class"]))])),_:1},8,["class"]),e.disabled||e.readonly?C("",!0):(m(),d(u,{key:0,"custom-class":"ht-picker__arrow",name:"arrow-right"}))])),_:1}),re.value?(m(),d(l,{key:0,class:"ht-picker__error-message"},{default:v((()=>[b(_(re.value),1)])),_:1})):C("",!0)])),_:1})])),_:3},8,["class"]))])),_:3}),f(s,{modelValue:G.value,"onUpdate:modelValue":a[2]||(a[2]=e=>G.value=e),position:"bottom","hide-when-close":!1,"close-on-click-modal":e.closeOnClickModal,"safe-area-inset-bottom":e.safeAreaInsetBottom,"z-index":e.zIndex,onClose:ye,"custom-class":"ht-picker__popup"},{default:v((()=>[f(l,{class:"ht-picker__wraper"},{default:v((()=>[f(l,{class:"ht-picker__toolbar",onTouchmove:me},{default:v((()=>[f(l,{class:"ht-picker__action ht-picker__action--cancel",onClick:ye},{default:v((()=>[b(_(e.cancelButtonText||V(K)("cancel")),1)])),_:1}),e.title?(m(),d(l,{key:0,class:"ht-picker__title"},{default:v((()=>[b(_(e.title),1)])),_:1})):C("",!0),f(l,{class:h("ht-picker__action "+(e.loading||le.value?"is-loading":"")),onClick:ge},{default:v((()=>[b(_(e.confirmButtonText||V(K)("confirm")),1)])),_:1},8,["class"])])),_:1}),E.value?(m(),d(l,{key:0,class:"ht-picker__region-tabs"},{default:v((()=>[f(l,{class:h(`ht-picker__region ${J.value?"is-active":""} `),onClick:fe},{default:v((()=>[f(l,null,{default:v((()=>[b(_(V(K)("start")),1)])),_:1}),f(l,{class:"ht-picker__region-time"},{default:v((()=>[b(_(Q.value[0]),1)])),_:1})])),_:1},8,["class"]),f(l,{class:h("ht-picker__region "+(J.value?"":"is-active")),onClick:fe},{default:v((()=>[f(l,null,{default:v((()=>[b(_(V(K)("end")),1)])),_:1}),f(l,{class:"ht-picker__region-time"},{default:v((()=>[b(_(Q.value[1]),1)])),_:1})])),_:1},8,["class"])])),_:1})):C("",!0),f(l,{class:h(J.value?"ht-picker__show":"ht-picker__hidden")},{default:v((()=>[f(r,{"custom-class":e.customViewClass,ref_key:"datetimePickerView",ref:L,type:e.type,modelValue:X.value,"onUpdate:modelValue":a[0]||(a[0]=e=>X.value=e),loading:e.loading||le.value,"loading-color":e.loadingColor,"columns-height":e.columnsHeight,"value-key":e.valueKey,"label-key":e.labelKey,formatter:e.formatter,filter:e.filter,"column-formatter":V(o)(e.modelValue)?ne:void 0,"max-hour":e.maxHour,"min-hour":e.minHour,"max-date":e.maxDate,"min-date":e.minDate,"max-minute":e.maxMinute,"min-minute":e.minMinute,"start-symbol":!0,"immediate-change":e.immediateChange,onChange:pe,onPickstart:be,onPickend:_e},null,8,["custom-class","type","modelValue","loading","loading-color","columns-height","value-key","label-key","formatter","filter","column-formatter","max-hour","min-hour","max-date","min-date","max-minute","min-minute","immediate-change"])])),_:1},8,["class"]),f(l,{class:h(J.value?"ht-picker__hidden":"ht-picker__show")},{default:v((()=>[f(r,{"custom-class":e.customViewClass,ref_key:"datetimePickerView1",ref:I,type:e.type,modelValue:Z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value=e),loading:e.loading||le.value,"loading-color":e.loadingColor,"columns-height":e.columnsHeight,"value-key":e.valueKey,"label-key":e.labelKey,formatter:e.formatter,filter:e.filter,"column-formatter":V(o)(e.modelValue)?ne:void 0,"max-hour":e.maxHour,"min-hour":e.minHour,"max-date":e.maxDate,"min-date":e.minDate,"max-minute":e.maxMinute,"min-minute":e.minMinute,"start-symbol":!1,"immediate-change":e.immediateChange,onChange:he,onPickstart:be,onPickend:_e},null,8,["custom-class","type","modelValue","loading","loading-color","columns-height","value-key","label-key","formatter","filter","column-formatter","max-hour","min-hour","max-date","min-date","max-minute","min-minute","immediate-change"])])),_:1},8,["class"])])),_:1})])),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-c9cfe427"]]);export{Y as _};
