import{d as e,r as a,c as t,z as l,b as s,e as r,f as n,g as o,w as i,A as u,p as d,B as m,x as c,h,i as f,t as g,j as p,k as v,l as w,F as _,aI as y,K as D,L as k,m as b,aV as Y,aw as C}from"./index-Bl407YMq.js";import{b as F,f as $,c as x,m as M,d as V,g as S,a as T,_ as j}from"./base64.CiSqhNY6.js";import{_ as O,a as W}from"./ht-tabs.BaQr-CzC.js";import{_ as I}from"./ht-tag.D3LZ4lyb.js";import{_ as z,i as A,g as q}from"./ht-calendar-view.Dl2rGeRc.js";import{_ as L}from"./ht-button.8vkNbh4T.js";import{_ as R}from"./ht-action-sheet.TkSIxoxA.js";import{d as U}from"./dayjs.BQz75yJF.js";import{f as B,u as H,F as P}from"./ht-loading.DCn6to1m.js";import{u as N}from"./useTranslate.C8VGrN03.js";const E=j(e({name:"ht-calendar",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...F,modelValue:$([Number,Array,null]),type:x("date"),minDate:M(new Date((new Date).getFullYear(),(new Date).getMonth()-6,(new Date).getDate()).getTime()),maxDate:M(new Date((new Date).getFullYear(),(new Date).getMonth()+6,(new Date).getDate(),23,59,59).getTime()),firstDayOfWeek:M(0),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:V(!1),defaultTime:{type:[String,Array]},timeFilter:Function,hideSecond:V(!1),label:String,labelWidth:String,disabled:V(!1),readonly:V(!1),placeholder:String,title:String,alignRight:V(!1),error:V(!1),required:V(!1),size:String,center:V(!1),closeOnClickModal:V(!0),zIndex:M(15),showConfirm:V(!0),confirmText:String,displayFormat:Function,innerDisplayFormat:Function,ellipsis:V(!1),showTypeSwitch:V(!1),shortcuts:S(),onShortcutsClick:Function,safeAreaInsetBottom:V(!0),beforeConfirm:Function,prop:String,rules:S(),customViewClass:x(""),customLabelClass:x(""),customValueClass:x(""),immediateChange:V(!1),withCell:V(!0)},emits:["cancel","change","update:modelValue","confirm","open"],setup(e,{expose:F,emit:$}){const{translate:x}=N("calendar"),M=(e,a)=>{switch(a){case"date":return U(e).format("YYYY-MM-DD");case"dates":return e.map((e=>U(e).format("YYYY-MM-DD"))).join(", ");case"daterange":return`${e[0]?U(e[0]).format("YYYY-MM-DD"):x("startTime")} ${x("to")} ${e[1]?U(e[1]).format("YYYY-MM-DD"):x("endTime")}`;case"datetime":return U(e).format("YYYY-MM-DD HH:mm:ss");case"datetimerange":return`${e[0]?U(e[0]).format(x("timeFormat")):x("startTime")} ${x("to")}\n${e[1]?U(e[1]).format(x("timeFormat")):x("endTime")}`;case"week":{const a=new Date(e),t=a.getFullYear(),l=q(e);new Date(a).setDate(a.getDate()-a.getDay()+1);const s=new Date(a);s.setDate(a.getDate()+(7-a.getDay()));const r=s.getFullYear()>t?s.getFullYear():t;return x("weekFormat",r,Y(l))}case"weekrange":{const a=new Date(e[0]),t=new Date(e[1]),l=a.getFullYear(),s=t.getFullYear(),r=q(e[0]),n=q(e[1]);new Date(a).setDate(a.getDate()-a.getDay()+1);const o=new Date(a);o.setDate(a.getDate()+(7-a.getDay()));new Date(t).setDate(t.getDate()-t.getDay()+1);const i=new Date(t);i.setDate(t.getDate()+(7-t.getDay()));const u=o.getFullYear()>l?o.getFullYear():l,d=i.getFullYear()>s?i.getFullYear():s;return`${e[0]?x("weekFormat",u,Y(r)):x("startWeek")} - ${e[1]?x("weekFormat",d,Y(n)):x("endWeek")}`}case"month":return U(e).format("YYYY / MM");case"monthrange":return`${e[0]?U(e[0]).format("YYYY / MM"):x("startMonth")} ${x("to")} ${e[1]?U(e[1]).format("YYYY / MM"):x("endMonth")}`}},V=(e,a,t)=>{switch(t){case"daterange":return e?U(e).format(x("dateFormat")):x("end"===a?"endTime":"startTime");case"datetimerange":return e?U(e).format(x("timeFormat")):x("end"===a?"endTime":"startTime");case"weekrange":{if(!e)return x("end"===a?"endWeek":"startWeek");const t=new Date(e).getFullYear(),l=q(e);return x("weekFormat",t,Y(l))}case"monthrange":return e?U(e).format(x("monthFormat")):x("end"===a?"endMonth":"startMonth")}},S=e,j=$,E=a(!1),G=a(null),K=a(null),J=a(338),Q=a(!0),X=a(0),Z=a(0),ee=a("date"),ae=a(),te=a(!1),le=B(),se=a(),re=a(),ne=t((()=>{const[e,a]=y(D(G.value)?G.value:[]);return[e,a].map(((e,a)=>(S.innerDisplayFormat||V)(e,0===a?"start":"end",ee.value)))})),oe=t((()=>!D(S.modelValue)&&S.modelValue||D(S.modelValue)&&S.modelValue.length?(S.displayFormat||M)(S.modelValue,ae.value||ee.value):""));l((()=>S.modelValue),((e,a)=>{C(e,a)||(G.value=y(e),Q.value=ge(e))}),{immediate:!0}),l((()=>S.type),((e,a)=>{if(S.showTypeSwitch){const a=["date","week","month"],t=["daterange","weekrange","monthrange"],l=e.indexOf("range")>-1?t.indexOf(e)||0:a.indexOf(e);X.value=l}J.value=S.showConfirm?338:400,ee.value=y(e)}),{deep:!0,immediate:!0}),l((()=>S.showConfirm),(e=>{J.value=e?338:400}),{deep:!0,immediate:!0});const{parent:ie}=H(P),ue=t((()=>ie&&S.prop&&ie.errorMessages&&ie.errorMessages[S.prop]?ie.errorMessages[S.prop]:"")),de=t((()=>{let e=!1;if(ie&&ie.props.rules){const a=ie.props.rules;for(const t in a)Object.prototype.hasOwnProperty.call(a,t)&&t===S.prop&&Array.isArray(a[t])&&(e=a[t].some((e=>e.required)))}return S.required||S.rules.some((e=>e.required))||e})),me=t((()=>e=>A(e)));async function ce(){const{disabled:e,readonly:a}=S;e||a||(te.value=!0,E.value=!0,K.value=y(G.value),Z.value=X.value,ae.value=ee.value,await k(),se.value&&se.value&&se.value.$.exposed.scrollIntoView(),setTimeout((()=>{S.showTypeSwitch&&(re.value.scrollIntoView(),re.value.updateLineStyle(!1))}),250),j("open"))}function he(){E.value=!1,setTimeout((()=>{G.value=y(K.value),X.value=Z.value,ee.value=ae.value||"date",Q.value=ge(K.value)}),250),j("cancel")}function fe({index:e}){const a=S.type.indexOf("range")>-1?["daterange","weekrange","monthrange"][e]:["date","week","month"][e];X.value=e,ee.value=a}function ge(e){let a=!1;return(!(S.type.indexOf("range")>-1)||D(e)&&e[0]&&e[1]&&e)&&("dates"!==S.type||D(e)&&0!==e.length&&e)&&e||(a=!0),a}function pe({value:e}){G.value=y(e),Q.value=ge(e),j("change",{value:e}),S.showConfirm||Q.value||ve()}function ve(){S.beforeConfirm?S.beforeConfirm({value:G.value,resolve:e=>{e&&we()}}):we()}function we(){E.value=!1,ae.value=ee.value,j("update:modelValue",G.value),j("confirm",{value:G.value,type:ee.value})}return F({close:he,open:ce}),(e,a)=>{const t=b,l=s(r("ht-icon"),T),k=s(r("ht-tab"),O),Y=s(r("ht-tabs"),W),C=s(r("ht-tag"),I),F=s(r("ht-calendar-view"),z),$=s(r("ht-button"),L),M=s(r("ht-action-sheet"),R);return n(),o(t,{class:d(`ht-calendar ${p(le).border.value?"is-border":""} ${e.customClass}`)},{default:i((()=>[e.withCell?(n(),o(t,{key:0,class:"ht-calendar__field",onClick:ce},{default:i((()=>[e.$slots.default?u(e.$slots,"default",{key:0},void 0,!0):(n(),o(t,{key:1,class:d(`ht-calendar__cell ${e.disabled?"is-disabled":""} ${S.readonly?"is-readonly":""} ${e.alignRight?"is-align-right":""} ${e.error?"is-error":""} ${e.size?"is-"+e.size:""} ${e.center?"is-center":""}`)},{default:i((()=>[e.label||e.$slots.label?(n(),o(t,{key:0,class:d(`ht-calendar__label ${de.value?"is-required":""} ${e.customLabelClass}`),style:m(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:i((()=>[u(e.$slots,"label",{},(()=>[f(g(e.label),1)]),!0)])),_:3},8,["class","style"])):c("",!0),h(t,{class:"ht-calendar__body"},{default:i((()=>[h(t,{class:"ht-calendar__value-wraper"},{default:i((()=>[h(t,{class:d(`ht-calendar__value ${e.ellipsis?"is-ellipsis":""} ${e.customValueClass} ${oe.value?"":"ht-calendar__value--placeholder"}`)},{default:i((()=>[f(g(oe.value||e.placeholder||p(x)("placeholder")),1)])),_:1},8,["class"]),e.disabled||e.readonly?c("",!0):(n(),o(l,{key:0,"custom-class":"ht-calendar__arrow",name:"arrow-right"}))])),_:1}),ue.value?(n(),o(t,{key:0,class:"ht-calendar__error-message"},{default:i((()=>[f(g(ue.value),1)])),_:1})):c("",!0)])),_:1})])),_:3},8,["class"]))])),_:3})):c("",!0),h(M,{modelValue:E.value,"onUpdate:modelValue":a[2]||(a[2]=e=>E.value=e),duration:250,"close-on-click-modal":e.closeOnClickModal,"safe-area-inset-bottom":e.safeAreaInsetBottom,"z-index":e.zIndex,onClose:he},{default:i((()=>[h(t,{class:"ht-calendar__header"},{default:i((()=>[e.showTypeSwitch||0!==e.shortcuts.length?c("",!0):(n(),o(t,{key:0,class:"ht-calendar__title"},{default:i((()=>[f(g(e.title||p(x)("title")),1)])),_:1})),e.showTypeSwitch?(n(),o(t,{key:1,class:"ht-calendar__tabs"},{default:i((()=>[h(Y,{ref_key:"calendarTabs",ref:re,modelValue:X.value,"onUpdate:modelValue":a[0]||(a[0]=e=>X.value=e),onChange:fe},{default:i((()=>[h(k,{title:p(x)("day"),name:p(x)("day")},null,8,["title","name"]),h(k,{title:p(x)("week"),name:p(x)("week")},null,8,["title","name"]),h(k,{title:p(x)("month"),name:p(x)("month")},null,8,["title","name"])])),_:1},8,["modelValue"])])),_:1})):c("",!0),e.shortcuts.length>0?(n(),o(t,{key:2,class:"ht-calendar__shortcuts"},{default:i((()=>[(n(!0),v(_,null,w(e.shortcuts,((e,a)=>(n(),o(C,{key:a,"custom-class":"ht-calendar__tag",type:"primary",plain:"",round:"",onClick:e=>function(e){S.onShortcutsClick&&"function"==typeof S.onShortcutsClick&&(G.value=y(S.onShortcutsClick({item:S.shortcuts[e],index:e})),Q.value=ge(G.value)),S.showConfirm||ve()}(a)},{default:i((()=>[f(g(e.text),1)])),_:2},1032,["onClick"])))),128))])),_:1})):c("",!0),h(l,{"custom-class":"ht-calendar__close",name:"add",onClick:he})])),_:1}),te.value?(n(),o(t,{key:0,class:d(`ht-calendar__view  ${ee.value.indexOf("range")>-1?"is-range":""} ${e.showConfirm?"is-show-confirm":""}`)},{default:i((()=>[me.value(e.type)?(n(),o(t,{key:0,class:d("ht-calendar__range-label "+("monthrange"===e.type?"is-monthrange":""))},{default:i((()=>[h(t,{class:d("ht-calendar__range-label-item "+(G.value&&p(D)(G.value)&&G.value[0]?"":"is-placeholder")),style:{"text-align":"right"}},{default:i((()=>[f(g(ne.value[0]),1)])),_:1},8,["class"]),h(t,{class:"ht-calendar__range-sperator"},{default:i((()=>[f("/")])),_:1}),h(t,{class:d("ht-calendar__range-label-item "+(G.value&&p(D)(G.value)&&G.value[1]?"":"is-placeholder"))},{default:i((()=>[f(g(ne.value[1]),1)])),_:1},8,["class"])])),_:1},8,["class"])):c("",!0),h(F,{ref_key:"calendarView",ref:se,modelValue:G.value,"onUpdate:modelValue":a[1]||(a[1]=e=>G.value=e),type:ee.value,"min-date":e.minDate,"max-date":e.maxDate,"first-day-of-week":e.firstDayOfWeek,formatter:e.formatter,"panel-height":J.value,"max-range":e.maxRange,"range-prompt":e.rangePrompt,"allow-same-day":e.allowSameDay,"default-time":e.defaultTime,"time-filter":e.timeFilter,"hide-second":e.hideSecond,"show-panel-title":!me.value(e.type),"immediate-change":e.immediateChange,onChange:pe},null,8,["modelValue","type","min-date","max-date","first-day-of-week","formatter","panel-height","max-range","range-prompt","allow-same-day","default-time","time-filter","hide-second","show-panel-title","immediate-change"])])),_:1},8,["class"])):c("",!0),e.showConfirm?(n(),o(t,{key:1,class:"ht-calendar__confirm"},{default:i((()=>[h($,{block:"",disabled:Q.value,onClick:ve},{default:i((()=>[f(g(e.confirmText||p(x)("confirm")),1)])),_:1},8,["disabled"])])),_:1})):c("",!0)])),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index"])])),_:3},8,["class"])}}}),[["__scopeId","data-v-fa441a04"]]);export{E as _};
