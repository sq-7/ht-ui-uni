import{b as t,f as n,n as e,m as a,d as u,e as s,c as i,a as o,_ as l}from"./base64.CiSqhNY6.js";import{a6 as r,d as c,r as d,c as p,z as m,J as b,b as h,e as f,f as v,g as _,w as g,h as N,p as w,H as x,B as I,x as M,aw as y,m as S,ah as W,ay as B}from"./index-Bl407YMq.js";var P=(t=>(t.Input="input",t.Blur="blur",t.Watch="watch",t.Button="button",t))(P||{});function T(){}const V=l(c({name:"ht-input-number",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...t,modelValue:n(e),min:a(1),max:a(Number.MAX_SAFE_INTEGER),step:a(1),stepStrictly:u(!1),precision:s(0),disabled:u(!1),disableInput:u(!1),disableMinus:u(!1),disablePlus:u(!1),withoutInput:u(!1),inputWidth:s(36),allowNull:u(!1),placeholder:i(""),adjustPosition:u(!0),beforeChange:Function,longPress:u(!1)},emits:["focus","blur","change","update:modelValue"],setup(t,{emit:n}){const e=t,a=n,u=d(function(){const t=J(e.modelValue);c(t,e.modelValue)||a("update:modelValue",t);return t}());let s=null;const i=p((()=>{const t=J(u.value),{disabled:n,min:a,step:s}=e;return n||Number(t)<=a||F(t,-s)<a})),l=p((()=>{const t=J(u.value),{disabled:n,max:a,step:s}=e;return n||Number(t)>=a||F(t,s)>a}));function c(t,n){return y(String(t),String(n))}function V(t){const n=Number(e.precision);return Number(parseFloat(""+Math.round(t*Math.pow(10,n))/Math.pow(10,n)).toFixed(n))}function C(t){if(!b(t))return 0;const n=t.toString(),e=n.indexOf(".");let a=0;return-1!==e&&(a=n.length-e-1),a}function j(t,n=P.Input){const s=n!==P.Watch,i=n===P.Blur||n===P.Button;if((n===P.Input||n===P.Watch)&&String(t).endsWith(".")&&e.precision)return u.value=t,void B((()=>{u.value=function(t){if(Number(e.precision)>0){const n=t.indexOf(".");return-1===n?t:t.substring(0,n+1)+t.substring(n+1).replace(/\./g,"")}{const n=t.indexOf(".");return-1!==n?t.substring(0,n):t}}(String(t)),a("update:modelValue",u.value),a("change",{value:u.value})}));if(!i&&c(t,u.value))return;const o=()=>function(t){u.value=t;const n=J(t);B((()=>{u.value=n,a("update:modelValue",u.value),a("change",{value:u.value})}))}(t);s?function(t,{args:n=[],done:e,canceled:a,error:u}){if(t){const s=t.apply(null,n);r(s)?s.then((t=>{t?e():a&&a()})).catch(u||T):s?e():a&&a()}else e()}(e.beforeChange,{args:[t],done:o}):o()}function F(t,n){if(t=Number(t),isNaN(t))return e.min;const a=Math.max(C(t),C(n)),u=Math.pow(10,a);return V((t*u+n*u)/u)}function k(t){!function(t){if(t<0&&(i.value||e.disableMinus)||t>0&&(l.value||e.disablePlus))return;j(F(u.value,t),P.Button)}("add"===t?e.step:-e.step)}function E(t){j(t.detail.value||"",P.Input)}function O(t){const n=t.detail.value||"";j(n,P.Blur),a("blur",{value:n})}function $(t){H(),s=setTimeout((()=>{k(t),$(t)}),250)}function A(t){e.longPress&&(H(),s=setTimeout((()=>{k(t),$(t)}),600))}function G(){e.longPress&&H()}function H(){s&&(clearTimeout(s),s=null)}function z(t){a("focus",t.detail)}function J(t){if(e.allowNull&&(!b(t)||""===t))return"";let n=Number(t);return isNaN(n)&&(n=e.min),e.stepStrictly&&(n=function(t){const n=C(e.step),a=Math.pow(10,n);return Math.round(Number(t)/e.step)*a*e.step/a}(t)),n=Math.min(Math.max(n,e.min),e.max),b(e.precision)&&(n=V(n)),n}return m((()=>e.modelValue),(t=>{j(t,P.Watch)})),m([()=>e.max,()=>e.min,()=>e.precision],(()=>{j(J(u.value),P.Watch)})),(t,n)=>{const e=h(f("ht-icon"),o),a=S,s=W;return v(),_(a,{class:w(`ht-input-number ${t.customClass} ${t.disabled?"is-disabled":""} ${t.withoutInput?"is-without-input":""}`),style:I(t.customStyle)},{default:g((()=>[N(a,{class:w("ht-input-number__action "+(i.value||t.disableMinus?"is-disabled":"")),onClick:n[0]||(n[0]=t=>k("sub")),onTouchstart:n[1]||(n[1]=t=>A("sub")),onTouchend:x(G,["stop"])},{default:g((()=>[N(e,{name:"decrease","custom-class":"ht-input-number__action-icon"})])),_:1},8,["class"]),t.withoutInput?M("",!0):(v(),_(a,{key:0,class:"ht-input-number__inner",onClick:n[2]||(n[2]=x((()=>{}),["stop"]))},{default:g((()=>[N(s,{class:"ht-input-number__input",style:I(""+(t.inputWidth?"width: "+t.inputWidth:"")),type:"digit",disabled:t.disabled||t.disableInput,value:String(u.value),placeholder:t.placeholder,"adjust-position":t.adjustPosition,onInput:E,onFocus:z,onBlur:O},null,8,["style","disabled","value","placeholder","adjust-position"]),N(a,{class:"ht-input-number__input-border"})])),_:1})),N(a,{class:w("ht-input-number__action "+(l.value||t.disablePlus?"is-disabled":"")),onClick:n[3]||(n[3]=t=>k("add")),onTouchstart:n[4]||(n[4]=t=>A("add")),onTouchend:x(G,["stop"])},{default:g((()=>[N(e,{name:"add","custom-class":"ht-input-number__action-icon"})])),_:1},8,["class"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-fbe52676"]]);export{V as _};
