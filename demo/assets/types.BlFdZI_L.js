import{ab as e,$ as a,aC as t,aD as s,aE as o,K as r}from"./index-Bl407YMq.js";import{b as i,g as n,c as u,d as l,m as c}from"./base64.CiSqhNY6.js";const m={PENDING:"pending",LOADING:"loading",SUCCESS:"success",FAIL:"fail"};function p(){let i=null;const n=e=>{e?e.abort():i&&(i.abort(),i=null)};function u(e){return r(e.tempFiles)?e.tempFiles.map((e=>({path:e.path||"",name:e.name||"",size:e.size,type:"image",thumb:e.path||""}))):[{path:e.tempFiles.path||"",name:e.tempFiles.name||"",size:e.tempFiles.size,type:"image",thumb:e.tempFiles.path||""}]}return{startUpload:(a,t)=>{const{uploadMethod:s,formData:r={},action:u,name:l="file",header:c={},fileType:p="image",statusCode:d=200,statusKey:f="status",abortPrevious:h=!1}=t;a[f]=m.LOADING;const b={action:u,header:c,name:l,fileName:l,fileType:p,statusCode:d,abortPrevious:h,onSuccess:(e,a,s)=>{var o;a[f]=m.SUCCESS,i=null,null==(o=t.onSuccess)||o.call(t,e,a,s)},onError:(e,a,s)=>{var o;a[f]=m.FAIL,a.error=e.errMsg,i=null,null==(o=t.onError)||o.call(t,e,a,s)},onProgress:(e,a)=>{var s;a.percent=e.progress,null==(s=t.onProgress)||s.call(t,e,a)}};return e(s)?s(a,r,b):((e,a,t)=>{t.abortPrevious&&n();const s=o({url:t.action,header:t.header,name:t.name,fileName:t.name,fileType:t.fileType,formData:a,filePath:e.url,success(s){s.statusCode===t.statusCode?t.onSuccess(s,e,a):t.onError({...s,errMsg:s.errMsg||""},e,a)},fail(s){t.onError(s,e,a)}});return i=s,s.onProgressUpdate((a=>{t.onProgress(a,e)})),s})(a,r,b)},abort:n,UPLOAD_STATUS:m,chooseFile:function({multiple:e,sizeType:o,sourceType:r,maxCount:i,accept:n,compressed:l,maxDuration:c,camera:m,extension:p}){return new Promise(((d,f)=>{switch(n){case"image":default:a({count:e?Math.min(i||9,9):1,sizeType:o,sourceType:r,extension:p,success:e=>d(u(e)),fail:f});break;case"video":s({sourceType:r,compressed:l,maxDuration:c,camera:m,extension:p,success:e=>d(function(e){return[{path:e.tempFilePath||e.filePath||"",name:e.name||"",size:e.size,type:"video",thumb:e.thumbTempFilePath||"",duration:e.duration}]}(e)),fail:f});break;case"all":t({count:e?Math.min(i||100,100):1,type:n,extension:p,success:e=>d(e.tempFiles),fail:f})}}))}}}const d={...i,fileList:n(),action:u(""),header:{type:Object,default:()=>({})},multiple:l(!1),disabled:l(!1),limit:Number,showLimitNum:l(!0),maxSize:c(Number.MAX_VALUE),sourceType:{type:Array,default:()=>["album","camera"]},sizeType:{type:Array,default:()=>["original","compressed"]},name:u("file"),formData:{type:Object,default:()=>{}},onPreviewFail:Function,beforeUpload:Function,beforeChoose:Function,beforeRemove:Function,beforePreview:Function,buildFormData:Function,loadingType:u("ring"),loadingColor:u("#ffffff"),accept:u("image"),statusKey:u("status"),loadingSize:u("24px"),compressed:l(!0),maxDuration:c(60),camera:u("back"),imageMode:u("aspectFit"),successStatus:c(200),customEvokeClass:u(""),customPreviewClass:u(""),autoUpload:l(!0),reupload:l(!1),uploadMethod:Function,extension:Array};export{d as a,p as u};
