import{d as e,r as l,c as a,z as o,a4 as t,K as s,b as r,e as i,f as c,g as u,w as n,h as d,A as p,p as m,B as h,k as f,i as v,t as b,F as y,x as k,j as _,H as g,l as x,J as C,G as V,L as $,ay as w,m as K,aA as S,ab as z,I as j,n as F}from"./index-Bl407YMq.js";import{b as I,c as A,d as B,m as M,f as O,g as T,a as q,_ as L}from"./base64.CiSqhNY6.js";import{_ as P}from"./ht-search.D_wM0uHf.js";import{_ as U}from"./ht-checkbox.DwPcFwmz.js";import{_ as W}from"./ht-checkbox-group.BEnM4sur.js";import{_ as D,a as R}from"./ht-radio-group.ChiWSKvq.js";import{f as E,u as G,c as H,F as J}from"./ht-loading.DCn6to1m.js";import{_ as N}from"./ht-button.8vkNbh4T.js";import{_ as Z}from"./ht-action-sheet.TkSIxoxA.js";import{u as Q}from"./useTranslate.C8VGrN03.js";const X=L(e({name:"ht-select-picker",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...I,label:String,labelWidth:A("33%"),disabled:B(!1),readonly:Boolean,placeholder:String,title:String,alignRight:B(!1),error:B(!1),required:B(!1),useLabelSlot:B(!1),useDefaultSlot:B(!1),size:String,checkedColor:String,min:M(0),max:M(0),selectSize:String,loading:B(!1),loadingColor:A("#4D80F0"),closeOnClickModal:B(!0),modelValue:O([String,Number,Boolean,Array]),columns:T(),type:A("checkbox"),valueKey:A("value"),labelKey:A("label"),confirmButtonText:String,displayFormat:Function,beforeConfirm:Function,zIndex:M(15),safeAreaInsetBottom:B(!0),filterable:B(!1),filterPlaceholder:String,ellipsis:B(!1),scrollIntoView:B(!0),prop:String,rules:T(),customContentClass:A(""),customLabelClass:A(""),customValueClass:A(""),showConfirm:B(!0),clearable:B(!1)},emits:["change","cancel","confirm","clear","update:modelValue","open","close"],setup(e,{expose:I,emit:A}){const{translate:B}=Q("select-picker"),M=e,O=A,T=l(!1),L=l([]),X=l(!1),Y=l([]),ee=l(""),le=l([]),ae=l(0),oe=E(),te=a((()=>{const e=de(M.modelValue);let l="";if(M.displayFormat)l=M.displayFormat(e,M.columns);else{const{type:a,labelKey:o}=M;if("checkbox"===a){l=(s(e)?e:[]).map((e=>ne(e))).map((e=>e[o])).join(", ")}else if("radio"===a){l=ne(e)[o]}else l=e}return l}));o((()=>M.modelValue),(e=>{e!==L.value&&(L.value=de(e),Y.value=de(e))}),{deep:!0,immediate:!0}),o((()=>M.columns),(e=>{M.filterable&&ee.value?ke(e,ee.value):le.value=e}),{deep:!0,immediate:!0}),o((()=>M.displayFormat),(e=>{e&&!z(e)&&console.error("The type of displayFormat must be Function")}),{deep:!0,immediate:!0}),o((()=>M.beforeConfirm),(e=>{e&&!z(e)&&console.error("The type of beforeConfirm must be Function")}),{deep:!0,immediate:!0});const{parent:se}=G(J),re=a((()=>se&&M.prop&&se.errorMessages&&se.errorMessages[M.prop]?se.errorMessages[M.prop]:"")),ie=a((()=>{let e=!1;if(se&&se.props.rules){const l=se.props.rules;for(const a in l)Object.prototype.hasOwnProperty.call(l,a)&&a===M.prop&&Array.isArray(l[a])&&(e=l[a].some((e=>e.required)))}return M.required||M.rules.some((e=>e.required))||e}));t((()=>{L.value=de(M.modelValue),le.value=M.columns}));const{proxy:ce}=j();function ue(){}function ne(e){const{valueKey:l,labelKey:a,columns:o}=M,t=o.filter((a=>a[l]===e));return t.length>0?t[0]:{[l]:e,[a]:""}}function de(e){return"checkbox"===M.type?s(e)?e:[]:e}function pe({value:e}){L.value=e,O("change",{value:e}),"radio"!==M.type||M.showConfirm||fe()}function me(){T.value=!1,X.value||(L.value=de(Y.value)),O("cancel"),O("close")}function he(){M.disabled||M.readonly||(L.value=de(M.modelValue),T.value=!0,X.value=!1,O("open"))}function fe(){if(M.loading)return T.value=!1,O("confirm"),void O("close");M.beforeConfirm?M.beforeConfirm(L.value,(e=>{e&&ve()})):ve()}function ve(){X.value=!0,T.value=!1,Y.value=de(L.value);let e={};e="checkbox"===M.type?(s(Y.value)?Y.value:[]).map((e=>ne(e))):ne(Y.value),O("update:modelValue",Y.value),O("confirm",{value:Y.value,selectedItems:e}),O("close")}function be(e,l){const a=new RegExp(`(${l})`,"g");return e.split(a).map((e=>({type:e===l?"active":"normal",label:e})))}function ye({value:e}){""===e?(le.value=[],ee.value=e,w((()=>{le.value=M.columns}))):(ee.value=e,ke(M.columns,e))}function ke(e,l){const a=e.filter((e=>e[M.labelKey].indexOf(l)>-1)).map((e=>({...e,[M.labelKey]:be(e[M.labelKey],l)})));le.value=[],w((()=>{le.value=a}))}const _e=a((()=>"radio"===M.type&&M.showConfirm||"checkbox"===M.type)),ge=a((()=>M.clearable&&!M.disabled&&!M.readonly&&te.value.length));function xe(){O("update:modelValue","checkbox"===M.type?[]:""),O("clear")}const Ce=a((()=>!M.disabled&&!M.readonly&&!ge.value));return I({close:me,open:he}),(e,l)=>{const a=K,o=r(i("ht-icon"),q),t=r(i("ht-search"),P),z=F,j=r(i("ht-checkbox"),U),I=r(i("ht-checkbox-group"),W),A=r(i("ht-radio"),D),O=r(i("ht-radio-group"),R),E=r(i("ht-loading"),H),G=S,J=r(i("ht-button"),N),Q=r(i("ht-action-sheet"),Z);return c(),u(a,{class:m(`ht-select-picker ${_(oe).border.value?"is-border":""} ${e.customClass}`),style:h(e.customStyle)},{default:n((()=>[d(a,{class:"ht-select-picker__field",onClick:he},{default:n((()=>[e.useDefaultSlot?p(e.$slots,"default",{key:0},void 0,!0):(c(),u(a,{key:1,class:m(`ht-select-picker__cell ${e.disabled&&"is-disabled"} ${M.readonly&&"is-readonly"} ${e.alignRight&&"is-align-right"} ${e.error&&"is-error"} ${e.size&&"is-"+e.size}`)},{default:n((()=>[e.label||e.useLabelSlot?(c(),u(a,{key:0,class:m(`ht-select-picker__label ${ie.value&&"is-required"} ${e.customLabelClass}`),style:h(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:n((()=>[e.label?(c(),f(y,{key:0},[v(b(e.label),1)],64)):p(e.$slots,"label",{key:1},void 0,!0)])),_:3},8,["class","style"])):k("",!0),d(a,{class:"ht-select-picker__body"},{default:n((()=>[d(a,{class:"ht-select-picker__value-wraper"},{default:n((()=>[d(a,{class:m(`ht-select-picker__value ${e.ellipsis&&"is-ellipsis"} ${e.customValueClass} ${te.value?"":"ht-select-picker__value--placeholder"}`)},{default:n((()=>[v(b(te.value||e.placeholder||_(B)("placeholder")),1)])),_:1},8,["class"]),Ce.value?(c(),u(o,{key:0,"custom-class":"ht-select-picker__arrow",name:"arrow-right"})):ge.value?(c(),u(a,{key:1,onClick:g(xe,["stop"])},{default:n((()=>[d(o,{"custom-class":"ht-select-picker__clear",name:"error-fill"})])),_:1})):k("",!0)])),_:1}),re.value?(c(),u(a,{key:0,class:"ht-select-picker__error-message"},{default:n((()=>[v(b(re.value),1)])),_:1})):k("",!0)])),_:1})])),_:3},8,["class"]))])),_:3}),d(Q,{modelValue:T.value,"onUpdate:modelValue":l[3]||(l[3]=e=>T.value=e),duration:250,title:e.title||_(B)("title"),"close-on-click-modal":e.closeOnClickModal,"z-index":e.zIndex,"safe-area-inset-bottom":e.safeAreaInsetBottom,onClose:me,onOpened:l[4]||(l[4]=l=>e.scrollIntoView?async function(){let e="",l=[];C(L.value)&&""!==L.value&&!s(L.value)?(e="#ht-radio-group",l=[V(`#radio${L.value}`,!1,ce)]):s(L.value)&&L.value.length>0&&(L.value.forEach((e=>{l.push(V(`#check${e}`,!1,ce))})),e="#ht-checkbox-group"),e&&(await $(2e3/30),Promise.all([V(".ht-select-picker__wrapper",!1,ce),V(e,!1,ce),...l]).then((e=>{if(C(e)&&s(e)){const l=e[0],a=e[1],o=e.slice(2)||[];C(a)&&C(l)&&o.findIndex((e=>e.bottom>l.top&&e.top<l.bottom))<0&&(ae.value=-1,w((()=>{ae.value=Math.max(0,o[0].top-a.top-l.height/2)})))}})))}():""),"custom-header-class":"ht-select-picker__header"},{default:n((()=>[e.filterable?(c(),u(t,{key:0,modelValue:ee.value,"onUpdate:modelValue":l[0]||(l[0]=e=>ee.value=e),placeholder:e.filterPlaceholder||_(B)("filterPlaceholder"),"hide-cancel":"","placeholder-left":"",onChange:ye},null,8,["modelValue","placeholder"])):k("",!0),d(G,{class:m(`ht-select-picker__wrapper ${e.filterable?"is-filterable":""} ${e.loading?"is-loading":""} ${e.customContentClass}`),"scroll-y":!e.loading,"scroll-top":ae.value,"scroll-with-animation":!0},{default:n((()=>["checkbox"===e.type&&_(s)(L.value)?(c(),u(a,{key:0,id:"ht-checkbox-group"},{default:n((()=>[d(I,{modelValue:L.value,"onUpdate:modelValue":l[1]||(l[1]=e=>L.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,min:e.min,max:e.max,onChange:pe},{default:n((()=>[(c(!0),f(y,null,x(le.value,(l=>(c(),u(a,{key:l[e.valueKey],id:"check"+l[e.valueKey]},{default:n((()=>[d(j,{modelValue:l[e.valueKey],disabled:l.disabled},{default:n((()=>[e.filterable&&ee.value?(c(!0),f(y,{key:0},x(l[e.labelKey],(e=>(c(),f(y,{key:e.label},["active"===e.type?(c(),u(z,{key:0,class:"ht-select-picker__text-active"},{default:n((()=>[v(b(e.label),1)])),_:2},1024)):(c(),f(y,{key:1},[v(b(e.label),1)],64))],64)))),128)):(c(),f(y,{key:1},[v(b(l[e.labelKey]),1)],64))])),_:2},1032,["modelValue","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color","min","max"])])),_:1})):k("",!0),"radio"!==e.type||_(s)(L.value)?k("",!0):(c(),u(a,{key:1,id:"ht-radio-group"},{default:n((()=>[d(O,{modelValue:L.value,"onUpdate:modelValue":l[2]||(l[2]=e=>L.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,onChange:pe},{default:n((()=>[(c(!0),f(y,null,x(le.value,((l,o)=>(c(),u(a,{key:o,id:"radio"+l[e.valueKey]},{default:n((()=>[d(A,{value:l[e.valueKey],disabled:l.disabled},{default:n((()=>[e.filterable&&ee.value?(c(!0),f(y,{key:0},x(l[e.labelKey],(e=>(c(),u(z,{key:e.label,class:m(""+("active"===e.type?"ht-select-picker__text-active":""))},{default:n((()=>[v(b(e.label),1)])),_:2},1032,["class"])))),128)):(c(),f(y,{key:1},[v(b(l[e.labelKey]),1)],64))])),_:2},1032,["value","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color"])])),_:1})),e.loading?(c(),u(a,{key:2,class:"ht-select-picker__loading",onTouchmove:ue},{default:n((()=>[d(E,{color:e.loadingColor},null,8,["color"])])),_:1})):k("",!0)])),_:1},8,["class","scroll-y","scroll-top"]),_e.value?(c(),u(a,{key:1,class:"ht-select-picker__footer"},{default:n((()=>[d(J,{block:"",size:"large",onClick:fe,disabled:e.loading},{default:n((()=>[v(b(e.confirmButtonText||_(B)("confirm")),1)])),_:1},8,["disabled"])])),_:1})):k("",!0)])),_:1},8,["modelValue","title","close-on-click-modal","z-index","safe-area-inset-bottom"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-317cefba"]]);export{X as _};
